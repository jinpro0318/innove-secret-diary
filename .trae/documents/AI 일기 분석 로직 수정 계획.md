# AI 일기 분석 로직 수정 계획

사용자께서 겪으신 "내용이 완전히 달라지는 현상"은 두 가지 원인이 있을 수 있습니다.
1.  **API 키 누락/오류 시**: 백엔드가 예시 문구("오늘 하루는 정말 평온했다...")를 반환하도록 되어 있어, 사용자의 입력이 무시되는 현상.
2.  **AI 창작 과다**: AI가 내용을 너무 많이 지어내는 경우.

이를 해결하기 위해 다음 조치를 취하겠습니다.

## 1. 예외 처리(Fallback) 로직 개선
- **API 호출 실패 시**: 더 이상 고정된 예시 텍스트를 반환하지 않고, **사용자가 입력한 원본 텍스트를 그대로 반환**하도록 수정합니다. 이렇게 하면 API 키가 없거나 오류가 나더라도 최소한 사용자의 글이 사라지지는 않습니다.

## 2. 프롬프트 최적화 (Prompt Engineering)
- AI에게 "기존 내용을 기반으로 확장"하되, **"팩트를 유지하라(Keep the facts)"**는 제약을 더 강력하게 부여합니다.
- 단순히 문법만 고치는 것을 넘어, 사용자가 쓴 단어와 상황을 그대로 살리면서 문장 끝맺음만 일기체(~했다)로 다듬도록 지시합니다.

## 실행 계획
1.  `src/app/api/diary/analyze/route.ts` 수정:
    - `catch` 블록에서 `rewritten_content`를 `content`(사용자 입력)로 설정.
    - 프롬프트에 "Strictly based on provided text" 조건 강화.
