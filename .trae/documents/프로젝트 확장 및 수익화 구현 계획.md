# 프로젝트 확장 및 수익화 구현 계획

사용자의 요청에 따라 'AI 시크릿 일기장'을 확장하여 수익화 모델, AI 고도화, 그리고 보안 기능을 추가하겠습니다. 특히 **결제 페이지**와 **Gemini API 연동**을 최우선으로 진행합니다.

## 1. 프로젝트 구조 업데이트 (Project Structure Update)
새로운 기능(API, Auth, Payment)을 수용하기 위해 구조를 확장합니다.
```
src/
├── app/
│   ├── api/
│   │   └── diary/
│   │       └── analyze/    # [New] AI 일기 분석 API Route
│   ├── login/              # [New] 로그인 페이지
│   └── premium/            # [New] 결제 페이지
├── features/
│   ├── auth/               # [New] 인증 관련 컴포넌트 (SocialLogin)
│   └── premium/            # [New] 결제 관련 컴포넌트 (PricingCard)
├── lib/
│   └── supabase/           # [New] Supabase 클라이언트 설정 (Client/Server)
└── ...
```

## 2. Gemini API 연동 (AI Backend)
- **API Route**: `src/app/api/diary/analyze/route.ts` 생성.
- **기능**: 사용자의 일기 본문을 받아 Gemini에게 다음 정보를 JSON으로 요청.
    1.  **감정(Mood)**: 오늘의 감정 상태.
    2.  **키워드(Keywords)**: 핵심 단어 3개.
    3.  **색상(Color)**: 감정에 어울리는 추천 Hex 코드.
    4.  **스티커(Stickers)**: 추천 이모지 및 배치 좌표 제안.

## 3. 결제 시스템 구현 (Monetization)
- **페이지**: `src/app/premium/page.tsx` - 'Lifetime Access' 상품 소개.
- **연동**: PortOne (구 I'mport) V2 SDK 사용.
- **로직**:
    1.  사용자가 '구매하기' 클릭.
    2.  PortOne 결제창 호출.
    3.  결제 성공 시 Supabase `profiles` 테이블의 `is_premium` 값을 `true`로 업데이트하는 로직(Client/Server Sync).

## 4. Supabase Auth & Data Security
- **Auth**: 카카오/구글 로그인 버튼 구현 (`src/features/auth/SocialLogin.tsx`).
- **RLS Policy**: 사용자별 데이터 접근 제어를 위한 SQL 스니펫 제공 (일기장, 프로필).
- **Middleware**: 비로그인 유저 접근 제한 설정.

## 5. 실행 및 확인
- **Dev Server**: 모든 구현 후 `npm run dev`로 서버를 실행하여 웹사이트 접근 가능 상태로 전환.

## 실행 순서 (Priority Task)
1.  **Dependencies**: PortOne SDK 등 필요 라이브러리 확인.
2.  **Backend API**: `src/app/api/diary/analyze/route.ts` 구현 (Gemini).
3.  **Payment UI**: `src/app/premium/page.tsx` 및 결제 로직 구현.
4.  **Supabase Setup**: 클라이언트 설정 및 로그인 페이지 구현.
5.  **Run**: 개발 서버 실행.
